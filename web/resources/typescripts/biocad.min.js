var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,e){a!=Array.prototype&&a!=Object.prototype&&(a[c]=e.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,c,e,d){if(c){e=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var b=a[d];b in e||(e[b]={});e=e[b]}a=a[a.length-1];d=e[a];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(e,a,{configurable:!0,writable:!0,value:c})}};$jscomp.underscoreProtoCanBeSet=function(){var a={a:!0},c={};try{return c.__proto__=a,c.a}catch(e){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(a,c){a.__proto__=c;if(a.__proto__!==c)throw new TypeError(a+" is not extensible");return a}:null;$jscomp.polyfill("Object.setPrototypeOf",function(a){return a||$jscomp.setPrototypeOf},"es6","es5");$jscomp.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};
$jscomp.SYMBOL_PREFIX="jscomp_symbol_";$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}});$jscomp.initSymbolIterator=function(){}};
$jscomp.initSymbolAsyncIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.asyncIterator;a||(a=$jscomp.global.Symbol.asyncIterator=$jscomp.global.Symbol("asyncIterator"));$jscomp.initSymbolAsyncIterator=function(){}};$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var e=0,d={next:function(){if(e<a.length){var b=e++;return{value:c(b,a[b]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.keys",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},"es6","es3");
var __extends=this&&this.__extends||function(){var a=function(c,e){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])};return a(c,e)};return function(c,e){function d(){this.constructor=c}a(c,e);c.prototype=null===e?Object.create(e):(d.prototype=e.prototype,new d)}}(),bioCAD;
(function(a){(function(a){var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);Object.defineProperty(b.prototype,"appName",{get:function(){return"login"},enumerable:!0,configurable:!0});b.prototype.init=function(){};b.prototype.login_click=function(){b.do_login()};b.do_login=function(){var a=$ts.value("#username"),b=$ts.value("#password"),c=$ts("@api:login");$ts.post(c,{account:a,password:md5(b)},function(a){0==a.code?(a=$ts.location("goto",!1,"/"),a=decodeURIComponent(a),
Strings.Empty(a,!0)?parent.gotoURL("/"):parent.gotoURL(a)):parent.msgbox(a.info,1)})};return b}(Bootstrap);a.LoginScript=c})(a.WebApp||(a.WebApp={}))})(bioCAD||(bioCAD={}));
(function(a){(function(a){var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);Object.defineProperty(b.prototype,"appName",{get:function(){return"recover"},enumerable:!0,configurable:!0});b.prototype.init=function(){};b.doRecover_onclick=function(){throw"not implemented!";};return b}(Bootstrap);a.RecoverScript=c})(a.WebApp||(a.WebApp={}))})(bioCAD||(bioCAD={}));
(function(a){(function(a){var c=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);Object.defineProperty(b.prototype,"appName",{get:function(){return"register"},enumerable:!0,configurable:!0});b.prototype.init=function(){};b.prototype.doRegister_onclick=function(){var a=$ts("#username").CType().value,b=$ts("#email").CType().value,c=$ts("#password").CType().value,l=$ts("#check_terms_of_use").CType().checked,k=$ts("@api:register");l?a&&b&&c?$ts.post(k,{username:a,
password:md5(c),email:b},function(a){0==a.code?parent.gotoLogin():parent.msgbox(a.info,1)}):parent.msgbox("One of the required field is empty!",1):parent.msgbox("You should agree our bioCAD Terms of use at first!",1)};return b}(Bootstrap);a.RegisterScript=c})(a.WebApp||(a.WebApp={}))})(bioCAD||(bioCAD={}));var dev=console,logo=["%c\n\n  .Ci     .bi           oDDDi    iDi   .CDDDDl             .Ci                     .C.\n  .Ci     .bi         .bo  .c.   oCo   .Cl  .Cb.           .Ci                     .C.\n  .Ci                .Co        .CiA.  .Cl    oo           .Ci                     .C.\n  .CiCDDl .bi .CDDb. .A.        lo.Cl  .Cl    .A.     oDDl .Ci .CDDb. .bi  ib. .CDDcC.\n  .Cb. .bi.bi.Co  ib.iC.       .Ci iC. .Cl    .C.   .CC. i..Ci.Co  ib..bi  ib..Co  ob.\n  .Cl   oo.biib.   oliC.       .C. .bi .Cl    .C.   .C.    .Ciib.   ol.bi  ib..C.  .C.\n  .Ci   lo.biiC.   oo.C.       lDDDDDo .Cl    .C.   iC.    .CiiC.   oo.bi  ib.iC.  .C.\n  .Ci   ol.biib.   ol.Cl      .bi   ib..Cl    oo    ib.    .Ciib.   ol.bi  ib.ib.  .A.\n  .Cb. ib..bi.Co  ib. iDl  .c.ib.   .bl.Cl  .CC. .bi.Co  i..Ci.Co  ib..Co .Cb..bl .Cb.\n  .CibDDi .bi .CDDb.   .bDDb. oo     oC.CDDDDl   .bi .CDDl .Ci .CDDb.  .bDblb. .bDDiC.\n\n                                                                   http://bioCAD.cloud \n                                               xieguigang <xie.guigang@gcmodeller.org>\n\n"].concat(["color:#084B8A"]);
console.log.apply(dev,logo);(function(a){(function(a){a.start=function(){Router.AddAppHandler(new a.LoginScript);Router.AddAppHandler(new a.RegisterScript);Router.AddAppHandler(new a.RecoverScript);Router.AddAppHandler(new a.Platform.TaskMgr);Router.AddAppHandler(new a.Platform.Report);Router.RunApp()}})(a.WebApp||(a.WebApp={}))})(bioCAD||(bioCAD={}));$ts.mode=Modes.debug;$ts(bioCAD.WebApp.start);
(function(a){(function(a){(function(a){var c=function(a){function b(){var b=null!==a&&a.apply(this,arguments)||this;b.pathways=new Dictionary;b.data={y:new IEnumerator([])};return b}__extends(b,a);Object.defineProperty(b.prototype,"appName",{get:function(){return"reportViewer"},enumerable:!0,configurable:!0});b.prototype.updateChart=function(a){var b=this;this.makeChartInternal(function(){if("*"==a)return b.data.y;if(b.pathways.ContainsKey(a)){var c=b.pathways.Item(a),n=$from(c.keys);return b.data.y.Where(function(a){return n.Any(function(b){return b==
a.name})})}return b.data.y.Where(function(b){return a==b.name})}())};b.parseData=function(a){return a.headers.Where(function(a){return""!=a}).Select(function(b){var c=a.Column(b).Skip(1).Select(function(a,b){return[b,parseFloat(a)]});return{name:b,type:"line",smooth:!0,showSymbol:!1,clip:!0,data:c.ToArray(),emphasis:{focus:"series"},ymax:c.Select(function(a){return a[1]}).Max()}})};b.prototype.makeChart=function(a,c){a=b.parseData(a);this.myChart=c;this.data.y=a;this.makeChartInternal(a);c.on("legendselectchanged",
function(a){console.log(a)})};b.prototype.makeChartInternal=function(a){var b=TypeScript.Data.quantile(a.Select(function(a){return a.ymax}).ToArray(),.65),c=this.myChart;b={animation:!1,tooltip:{trigger:"none",axisPointer:{type:"cross"}},legend:{},grid:{top:40,left:50,right:40,bottom:50},xAxis:{name:"Time(ticks)",minorTick:{show:!0},minorSplitLine:{show:!0},nameLocation:"middle"},yAxis:{name:"Activity",min:0,max:Math.round(1.25*b),minorTick:{show:!0},minorSplitLine:{show:!0}},series:a.ToArray()};
console.log("lines:");console.log(a);b&&c.setOption(b,!0,!1)};b.prototype.init=function(){var a=this,b=document.getElementById("main"),c=echarts.init(b);$ts.getText("@data:PLAS",function(b){return a.makeChart($ts.csv(b,!1),c)});$ts.getText("@url:graph",function(b){return a.initPathwaySelector(JSON.parse(b))})};b.prototype.initPathwaySelector=function(a){var b=this,c=$ts("#pathway_list"),h=$ts("<optgroup>",{label:"Pathways"}),g=$ts("<optgroup>",{label:"Metabolites"}),d=this.pathways,e=this,n=[];h.appendChild($ts("<option>",
{value:"*"}).display("*"));for(var p=0,t=a.nodeDataArray;p<t.length;p++){var f=t[p];if(f.isGroup){var w={pathway:f.label,keys:[]},q=$ts("<option>",{value:f.key}),u=new uikit.suggestion_list.term(f.key,f.text);q.innerText=f.text;n.push(u);d.Add(f.key.toString(),w);h.appendChild(q)}}p=0;for(a=a.nodeDataArray;p<a.length;p++)f=a[p],!isNullOrUndefined(f.isGroup)&&f.isGroup||Strings.Empty(f.group,!0)||(t=d.Item(f.group.toString()),q=$ts("<option>",{value:f.label}),u=new uikit.suggestion_list.term(f.label,
f.label),q.innerText=f.label,t.keys.push(f.label),"valve"==f.category||Strings.Empty(f.label,!0)||(n.push(u),g.appendChild(q)));c.add(h);c.add(g);c.onchange=function(){var a=$ts.select.getOption("#pathway_list");isNullOrUndefined(a)||Strings.Empty(a)||e.updateChart(a.toString())};var x=uikit.suggestion_list.render.makeSuggestions(n,"#sample_suggests",function(a){return b.clickOnTerm(a)},5,!1,"");$ts("#sample_search").onkeyup=function(){var a=$ts.value("#sample_search");Strings.Empty(a,!0)?$ts("#sample_suggests").hide():
($ts("#sample_suggests").show(),x(a))}};b.prototype.clickOnTerm=function(a){};return b}(Bootstrap);a.Report=c})(a.Platform||(a.Platform={}))})(a.WebApp||(a.WebApp={}))})(bioCAD||(bioCAD={}));
(function(a){(function(a){(function(a){function c(a){switch(a.toString()){case "0":return"pending";case "200":return"completed";case "500":return"delayed";case "1":return"on_schedule"}}var b=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}__extends(b,a);Object.defineProperty(b.prototype,"appName",{get:function(){return"app_task"},enumerable:!0,configurable:!0});b.prototype.init=function(){var a=this;$ts.get("@data:task_list",function(b){0!=b.code?parent.msgbox(b.info,1):a.loadTable(b.info)});
a.totalTasks=parseInt($ts("@data:count_task"));TypeScript.logging.log("You have "+a.totalTasks+" tasks in total!",TypeScript.ConsoleColors.Magenta)};b.prototype.loadTable=function(a){for(var b=$ts("#tasklist").clear(),c=0;c<a.length;c++)b.appendElement(this.taskRow(a[c]))};b.prototype.getModelId=function(a){var b=Bencode.decode(a.parameters);console.log("get task model id for:");console.log(a);console.log(b);a=0;for(var c=["model","file"];a<c.length;a++){var g=c[a];if(g in b)return b[g]}return""};
b.prototype.taskRow=function(a){var b=a.app_view+"?guid="+this.getModelId(a),d=$ts("<th>").appendElement($ts("<div>",{class:["media","align-items-center"]}).appendElement('\n                        <a href="#" class="avatar rounded-circle mr-3">\n                            <img alt="Image placeholder"\n                                src="/resources/images/icons/'+a.name+'.png">\n                        </a>').appendElement('\n                        <div class="media-body">\n                            <a href="/task/report/?q='+
a.sha1+'" target="__blank">\n                                <h4 class="mb-0">'+a.title+"</h4>\n                            </a>                            \n                        </div>")),g=$ts("<td>").appendElement(a.create_time),l=$ts("<td>").appendElement(e[c(a.status)]),v=$ts("<td>").appendElement(a.finish_time||"n/a");a=$ts("<td>").appendElement(n[c(a.status)]);b=$ts("<td>",{class:"text-right"}).appendElement(h.replace("{$model_url}",b));return $ts("<tr>").appendElement(d).appendElement(g).appendElement(l).appendElement(v).appendElement(a).appendElement(b)};
return b}(Bootstrap);a.TaskMgr=b;var h='\n        <div class="dropdown">\n            <a class="btn btn-sm btn-icon-only text-light" href="#" role="button"\n                data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"\n                style="box-shadow: none;">\n\n                <i class="fas fa-ellipsis-v"></i>\n            </a>\n            <div class="dropdown-menu dropdown-menu-right dropdown-menu-arrow">\n                <a class="dropdown-item bg-danger" href="#">Delete</a>\n                <a class="dropdown-item" href="{$model_url}">View Model</a>\n                <a class="dropdown-item" href="#">Help</a>\n            </div>\n        </div>\n    ',
n={pending:'<div class="d-flex align-items-center">\n                                            <span class="mr-2">0%</span>\n                                            <div>\n                                                <div class="progress">\n                                                    <div class="progress-bar bg-warning" role="progressbar"\n                                                        aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"\n                                                        style="width: 1%;"></div>\n                                                </div>\n                                            </div>\n                                        </div>',
completed:'<div class="d-flex align-items-center">\n                                            <span class="mr-2">100%</span>\n                                            <div>\n                                                <div class="progress">\n                                                    <div class="progress-bar bg-success" role="progressbar"\n                                                        aria-valuenow="100" aria-valuemin="0" aria-valuemax="100"\n                                                        style="width: 100%;"></div>\n                                                </div>\n                                            </div>\n                                        </div>',
delayed:'<div class="d-flex align-items-center">\n                                            <span class="mr-2">{$pct}%</span>\n                                            <div>\n                                                <div class="progress">\n                                                    <div class="progress-bar bg-danger" role="progressbar"\n                                                        aria-valuenow="{$pct}" aria-valuemin="0" aria-valuemax="100"\n                                                        style="width: {$pct}%;"></div>\n                                                </div>\n                                            </div>\n                                        </div>',
on_schedule:'<div class="d-flex align-items-center">\n                                            <span class="mr-2">{$pct}%</span>\n                                            <div>\n                                                <div class="progress">\n                                                    <div class="progress-bar bg-info" role="progressbar"\n                                                        aria-valuenow="{$pct}" aria-valuemin="0" aria-valuemax="100"\n                                                        style="width: {$pct}%;"></div>\n                                                </div>\n                                            </div>\n                                        </div>'},
e={pending:'<span class="badge badge-dot mr-4" style="color: #fb6340 !important;">\n                      <i class="bg-warning"></i> pending\n                  </span>',completed:'<span class="badge badge-dot" style="color: #2dce89 !important;">\n                        <i class="bg-success"></i> completed\n                    </span>',delayed:'<span class="badge badge-dot mr-4" style="color:  #ec0c38 !important;">\n                      <i class="bg-danger"></i> error\n                  </span>',
on_schedule:'<span class="badge badge-dot" style="color: #11cdef !important;">\n                          <i class="bg-info"></i> running\n                      </span>'}})(a.Platform||(a.Platform={}))})(a.WebApp||(a.WebApp={}))})(bioCAD||(bioCAD={}));var uikit;
(function(a){(function(a){(function(c){function d(a,c,d,e,k,g,m,r){void 0===k&&(k=10);void 0===g&&(g=!1);void 0===m&&(m=null);void 0===r&&(r=null);var h=$ts(d);h&&(h.clear(),a.populateSuggestion(c,k,g).forEach(function(a){h.appendChild(b(a,r,e))}),isNullOrUndefined(m)||a.hasEquals(c,g)||(a=$ts("<a>",{href:executeJavaScript,text:c,title:c,onclick:function(){m(c)}}).display("add '"+c+"'"),h.append($ts("<div>",{class:r}).display(a))))}function b(a,b,c){var d=$ts("<a>",{href:executeJavaScript,text:a.term,
title:a.term,onclick:function(){c(a)}}).display(a.term);return $ts("<div>",{class:b}).display(d)}c.makeSuggestions=function(b,c,e,l,k,g,m){void 0===l&&(l=10);void 0===k&&(k=!1);void 0===g&&(g=null);void 0===m&&(m=null);var h=new a.suggestion(b);return function(a){d(h,a,c,e,l,k,m,g)}}})(a.render||(a.render={}))})(a.suggestion_list||(a.suggestion_list={}))})(uikit||(uikit={}));
(function(a){(function(a){var c=function(){function c(a){this.terms=a}c.prototype.hasEquals=function(a,c){void 0===c&&(c=!1);c||(a=a.toLowerCase());for(var b=0,d=this.terms;b<d.length;b++){var e=d[b];if(c){if(e.term.toLowerCase()==a)return!0}else if(e.term==a)return!0}return!1};c.prototype.populateSuggestion=function(b,d,e){void 0===d&&(d=5);void 0===e&&(e=!1);var h=b.toLowerCase(),l=$from(this.terms).Select(function(a){var d=c.getScore(a,b,h,e);return{term:a,score:d}}).OrderBy(function(a){return a.score}),
k=l.Where(function(b){return b.score!=a.NA}).Take(d).Select(function(a){return a.term}).ToArray();return k.length==d?k:c.makeAdditionalSuggestion(l,k,e,b,d)};c.makeAdditionalSuggestion=function(a,c,d,e,l){var b=e.toLowerCase();a=a.Skip(c.length).Select(function(a){a=a.term;var c=d?Levenshtein.ComputeDistance(a.term.toLowerCase(),b):Levenshtein.ComputeDistance(a.term,e);return{term:a,score:c}}).OrderBy(function(a){return a.score}).Take(l-c.length).Select(function(a){return a.term}).ToArray();return c.concat(a)};
c.getScore=function(b,c,d,e){return e?(b=b.term.toLowerCase(),a.term.indexOf(b,d)):b.dist(c)};return c}();a.suggestion=c})(a.suggestion_list||(a.suggestion_list={}))})(uikit||(uikit={}));
(function(a){(function(a){a.NA=1E11;var c=function(){function c(a,c){this.id=a;this.term=c}c.prototype.dist=function(a){return c.indexOf(this.term,a)};c.indexOf=function(b,c){return-1==b.indexOf(c)?a.NA:Math.abs(c.length-b.length)};return c}();a.term=c})(a.suggestion_list||(a.suggestion_list={}))})(uikit||(uikit={}));
