var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,e){b!=Array.prototype&&b!=Object.prototype&&(b[c]=e.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(b,c,e,d){if(c){e=$jscomp.global;b=b.split(".");for(d=0;d<b.length-1;d++){var a=b[d];a in e||(e[a]={});e=e[a]}b=b[b.length-1];d=e[b];c=c(d);c!=d&&null!=c&&$jscomp.defineProperty(e,b,{configurable:!0,writable:!0,value:c})}};$jscomp.underscoreProtoCanBeSet=function(){var b={a:!0},c={};try{return c.__proto__=b,c.a}catch(e){}return!1};
$jscomp.setPrototypeOf="function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(b,c){b.__proto__=c;if(b.__proto__!==c)throw new TypeError(b+" is not extensible");return b}:null;$jscomp.polyfill("Object.setPrototypeOf",function(b){return b||$jscomp.setPrototypeOf},"es6","es5");
var __extends=this&&this.__extends||function(){var b=function(c,e){b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,a){d.__proto__=a}||function(d,a){for(var h in a)a.hasOwnProperty(h)&&(d[h]=a[h])};return b(c,e)};return function(c,e){function d(){this.constructor=c}b(c,e);c.prototype=null===e?Object.create(e):(d.prototype=e.prototype,new d)}}(),biodeep;
(function(b){(function(b){b.start=function(){Router.AddAppHandler(new apps.Metabolic_pathway);Router.RunApp()}})(b.app||(b.app={}))})(biodeep||(biodeep={}));$ts.mode=Modes.debug;$ts(biodeep.app.start);var apps;
(function(b){var c=function(){function b(d,a,h,b,c){this.node=d;this.link=a;this.group=h;this.label=b;this.vm=c;console.log(this)}b.prototype.tick=function(){var b=this.vm,a=this;return function(){a.node.each(function(a){return a.innerBounds=a.bounds.inflate(-b.margin)});a.link.each(function(a){return a.route=cola.makeEdgeBetween(a.source.innerBounds,a.target.innerBounds,5)});a.link.attr("x1",function(a){return a.route.sourceIntersection.x}).attr("y1",function(a){return a.route.sourceIntersection.y}).attr("x2",
function(a){return a.route.arrowStart.x}).attr("y2",function(a){return a.route.arrowStart.y});a.label.each(function(a){var h=this.getBBox();a.width=h.width+2*b.margin+8;a.height=h.height+2*b.margin+8});a.node.attr("x",function(a){return a.innerBounds.x}).attr("y",function(a){return a.innerBounds.y}).attr("width",function(a){return a.innerBounds.width()}).attr("height",function(a){return a.innerBounds.height()});a.group.attr("x",function(a){return a.bounds.x}).attr("y",function(a){return a.bounds.y}).attr("width",
function(a){return a.bounds.width()}).attr("height",function(a){return a.bounds.height()});a.label.attr("transform",function(b){return a.transform(b)})}};b.prototype.transform=function(b){return"translate("+b.x+this.vm.margin+", "+(b.y+this.vm.margin-b.height/2)+")"};return b}();b.Cola_graph=c})(apps||(apps={}));
(function(b){var c=function(c){function d(){var a=c.call(this)||this;a.width=800;a.height=520;a.margin=6;a.pad=12;a.width=parseFloat($ts("@width"));a.height=parseFloat($ts("@height"));return a}__extends(d,c);Object.defineProperty(d.prototype,"appName",{get:function(){return"Metabolic_pathway"},enumerable:!0,configurable:!0});d.prototype.redraw=function(){this.vis.attr("transform","translate("+d3.event.translate+") scale("+d3.event.scale+")")};d.prototype.savePng=function(){saveSvgAsPng($ts("#canvas").childNodes.item(0),
"pathway.png")};d.prototype.init=function(){var a=this,b=$ts("@graph");this.d3cola=cola.d3adaptor(d3).linkDistance(60).avoidOverlaps(!0).size([this.width,this.height]);this.outer=d3.select($ts("#canvas")).append("svg").attr("width",this.width).attr("height",this.height).attr("pointer-events","all");this.outer.append("rect").attr("class","background").attr("width","100%").attr("height","100%").call(d3.behavior.zoom().on("zoom",function(){return a.redraw()}));this.vis=this.outer.append("g").attr("transform",
"translate(80,80) scale(0.7)");if("#"==b.charAt(0))this.d3cola.on("tick",this.loadGraph((new dataAdapter.parseDunnart(b)).getGraph()).tick());else $ts.getText(b,function(b){return a.d3cola.on("tick",a.loadGraph(JSON.parse(b)).tick())});console.log("intialization job done!")};d.prototype.loadGraph=function(a){var c=this,f=this.vis.append("g"),e=this.vis.append("g"),g=this.vis.append("g");console.log(JSON.stringify(a));this.d3cola.nodes(a.nodes).links(a.links).groups(a.groups).constraints(a.constraints).start();
this.outer.append("svg:defs").append("svg:marker").attr("id","end-arrow").attr("viewBox","0 -5 10 10").attr("refX",5).attr("markerWidth",3).attr("markerHeight",3).attr("orient","auto").append("svg:path").attr("d","M0,-5L10,0L0,5L2,0").attr("stroke-width","0px").attr("fill","#000");f=f.selectAll(".group").data(a.groups).enter().append("rect").attr("rx",8).attr("ry",8).attr("class","group").attr("style",function(a){return a.style});g=g.selectAll(".link").data(a.links).enter().append("line").attr("class",
"link");var k=e.selectAll(".node").data(a.nodes).enter().append("rect").attr("class","node").attr("width",function(a){return a.width+2*c.pad+2*c.margin}).attr("height",function(a){return a.height+2*c.pad+2*c.margin}).attr("rx",function(a){return a.rx}).attr("ry",function(a){return a.rx}).call(this.d3cola.drag);a=e.selectAll(".label").data(a.nodes).enter().append("text").attr("class","label").call(this.d3cola.drag);a.each(d.insertLinebreaks);k.append("title").text(function(a){return a.label});return new b.Cola_graph(k,
g,f,a,this)};d.insertLinebreaks=function(a){var b=d3.select(this);a=a.label.split(" ");b.text("");for(var d=0;d<a.length;d++){var c=a[d];c=b.append("tspan").text(c);c.attr("x",0).attr("dy","15").attr("font-size","12")}};return d}(Bootstrap);b.Metabolic_pathway=c})(apps||(apps={}));var PathwayNavigator;
(function(b){function c(b){var d=KEGG.brite.parseIDEntry(b.name),a=d.commonName||"KEGG";return isNullOrEmpty(b.children)?{id:d.id,text:a,children:null}:{id:d.id,text:a,children:$from(b.children).Select(c).ToArray()}}b.parseJsTree=c})(PathwayNavigator||(PathwayNavigator={}));var dataAdapter;
(function(b){var c=function(){function b(b){void 0===b&&(b="#embeddedsvg");this.nodeLookup={};this.sbsvg=d3.select($ts(b)).select("svg");this.graph={nodes:[],links:[],constraints:[],groups:[]}}b.prototype.getGraph=function(){var b=this;this.loadNodes(this.sbsvg);for(var a=0,c=this.sbsvg.selectAll(".connector")[0];a<c.length;a++){var f=c[a],e=f.getAttribute("dunnart:srcid");f=f.getAttribute("dunnart:dstid");e in this.nodeLookup?f in this.nodeLookup?this.graph.links.push({source:this.nodeLookup[e].index,
target:this.nodeLookup[f].index}):console.warn("missing node of "+f):console.warn("missing node of "+e)}a=0;for(c=this.sbsvg.selectAll(".cluster")[0];a<c.length;a++)e=c[a],this.graph.groups.push({leaves:e.getAttribute("dunnart:contains").split(" ").map(function(a){return b.nodeLookup[a].index}),style:e.getAttribute("style"),padding:10});a={};c=0;for(e=this.sbsvg.selectAll("[relType=alignment]")[0];c<e.length;c++){var g=e[c];f=g.getAttribute("constraintid");var k=this.nodeLookup[g.getAttribute("objoneid")].index;
g=parseInt(g.getAttribute("alignmentpos"));k={node:k,offset:0};f in a?a[f].offsets.push(k):this.graph.constraints.push(a[f]={type:"alignment",offsets:[k],axis:1==g?"y":"x"})}return this.graph};b.prototype.loadNodes=function(b){var a=0,c=0;for(b=b.selectAll("rect.shape")[0];c<b.length;c++){var d=b[c];this.graph.nodes.push(this.nodeLookup[d.id]={label:d.getAttribute("dunnart:label"),dunnartid:d.id,index:a++,width:60,height:40,x:parseFloat(d.getAttribute("x")),y:parseFloat(d.getAttribute("y")),rx:"rx"in
d.attributes?parseFloat(d.getAttribute("rx")):5,ry:"ry"in d.attributes?parseFloat(d.getAttribute("ry")):5})}};return b}();b.parseDunnart=c})(dataAdapter||(dataAdapter={}));
